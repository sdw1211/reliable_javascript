# 챕터 2 : 도구 다루기

## 테스팅 프레임워크

* 단위 테스트가 없는 기존 코드를 작업할 떈 실제 기능을 확인하는 테스트를 작성해야 한다. 그래야 밖으로 표출되는 기능을 변경하지 않은 상태에서 코드를 리팩토링할 수 있다.
* 테스트 코드를 먼저 작성하라는 의미는 코드의 테스트성을 차후에 두고 볼 문제가 아니라 우선적인 주요 관심사로 생각하는 것
* 테스트 하기 쉬운 코드가 유지 보수성과 확장성이 월등히 우수
* TDD 절차 : Test 만든다 --> Test를 성공하기 위한 최소한의 코딩을 한다 --> 래팩토링을 하여 중복을 없앤다 --> 코드가 완성될 때 까지 무한 반복
* 종합적인 테스트 꾸러미가 마련된 제품 코드를 확장 또는 보수할 때는 안도감을 느낄 수 있다... (정말?)
* 재스민 : 행위 주도 개발방식으로 자바스크립트 단위 테스트를 작성하기 위한 라이브러리
* 테스트 더블 : 어떤 함수/객체의 본래 구현부를 테스트 도중 다른 코드로 대체한 것
  1. 더미 : 보통 인자 리스트를 채우기 위해 사용되며, 전달은 하지만 실제로 사용되지는 않는다.
  2. 틀 : 더미를 조금 더 구현하여 아직 개발되지 않은 클래스나 메서드가 실제 작동하는 것처럼 보이게 만든 객체로 보통 리턴값은 하드 코딩한다.
  3. 스파이 : 틀과 비슷하지만 내부적으로 기록을 남긴다는 점이 다르다. 특정 객체가 사용되었는지, 예상되는 메서드가 특정한 인자로 호출되었는지 등의 상황을 감시하고 이러한 정보를 제공하기도 한다.
  4. 모의체 : 틀에서 조금 더 발전하여 실제로 간단히 구현된 코드를 갖고는 있지만, 운영 환경에서 사용할 수는 없는 객체다.
  5. 모형 : 더미, 틀, 스파이를 혼합한 형태와 비숫하나 행위를 검증하는 용도로 주로 사용된다.
* 외부 시스템과 연동하는 코드에 이상이 없는지 테스트하는 것을 통합 테스트라고 한다. 단위 테스트와 구별되야 함을 알아야 한다.

## 의존성 주입 프레임워크

* 의존성 주입하는 코드를 만들면 단위 테스트를 하기 편하다.
  ```javascript
  // 운영 환경
  var attendee = new Attendee(new A(), new B(), id);
  // 개발 환경
  var attendee = new Attendee(fakeA, fakeB, id);
  ```
* DI는 실제객체보다 주입한 스파이나 모의 객체에 더 많은 제어권을 안겨주므로 다양한 에러 조건과 기이한 상황을 만들어낼 수 있다.
* DI는 코드 재사용을 적극적으로 유도한다.
* 어떤 경우에 DI를 해야할까?
  1. 객체 또는 의존성 중 어느하나라도 DB, 설정파일, HTTP, 기타 인프라 등의 외부 자원에 의존하는가?
  2. 객체 내부에서 발생할지 모를 에러를 테스트에서 고려해야 하나?
  3. 특정한 방향으로 객체를 작동시켜야 할 테스트가 있는가?
  4. 이 서드파트 제공 객체가 아니라 온전히 내가 소유한 객체인가?
* 의존성 주입 프레임워크 작동 원리
  1. 애플리케이션이 시작되자마자 각 인젝터블 명을 확인하고 해당 인젝터블이 지난 의존성을 지칭하며 순서대로 DI 컨테이너에 등록한다.
  2. 객체가 필요하면 컨테이너에 요청한다.
  3. 컨테이너는 일단 요청받은 객체와 그 의존성을 모두 재귀적으로 인스턴스화한다. 그런 다음, 요건에 따라 필요한 객체에 각각 주입한다.
  